<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="BattleMapMain.Views.CharacterSheetsView"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:Models="clr-namespace:BattleMapMain.Models"
    xmlns:viewmodels="clr-namespace:BattleMapMain.ViewModels"
    Title="Character Sheets"
    x:DataType="viewmodels:CharacterSheetsViewModel"
    BackgroundColor="#f2f2f7"
    Shell.FlyoutBehavior="Disabled">

    <Grid>

        <ScrollView>
            <VerticalStackLayout Padding="16" Spacing="12">

                <Entry
                    BackgroundColor="White"
                    HeightRequest="50"
                    Placeholder="Search by character name"
                    PlaceholderColor="#888"
                    Text="{Binding SearchBar}"
                    TextColor="Black" />

                <CollectionView
                    x:Name="collection"
                    ItemsSource="{Binding SearchedCharacters}"
                    SelectedItem="{Binding SelectedCharacter}"
                    SelectionMode="Single">

                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="Models:Character">
                            <Border
                                Margin="0,5"
                                BackgroundColor="White"
                                Stroke="#ccc"
                                StrokeThickness="1">

                                <Grid Padding="10" ColumnDefinitions="*,Auto">
                                    <Label
                                        Grid.Column="0"
                                        FontAttributes="Bold"
                                        FontSize="16"
                                        Text="{Binding CharacterName}"
                                        TextColor="#333"
                                        VerticalTextAlignment="Center" />

                                    <Label
                                        Grid.Column="1"
                                        FontAttributes="Bold"
                                        FontSize="14"
                                        HorizontalTextAlignment="End"
                                        Text="{Binding Hp}"
                                        TextColor="#666"
                                        VerticalTextAlignment="Center" />
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>

                    <CollectionView.EmptyView>
                        <StackLayout
                            Padding="20"
                            HorizontalOptions="Center"
                            Spacing="10"
                            VerticalOptions="Center">
                            <Label
                                FontAttributes="Italic"
                                FontSize="16"
                                HorizontalOptions="Center"
                                Text="No characters found."
                                TextColor="#999" />
                        </StackLayout>
                    </CollectionView.EmptyView>
                </CollectionView>

            </VerticalStackLayout>
        </ScrollView>

        <Button
            Margin="20"
            BackgroundColor="#007AFF"
            Command="{Binding GoToAddCommand}"
            FontSize="24"
            HeightRequest="60"
            HorizontalOptions="End"
            Text="+"
            TextColor="White"
            VerticalOptions="End"
            WidthRequest="60" />
    </Grid>
</ContentPage>
